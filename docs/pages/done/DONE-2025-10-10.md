# DONE — 2025-10-10

## Summary
Owner-/Teilnehmer-Auswahl in **index.html** implementiert (Floating Panel, Duplikatsperre, Start-Gate), Chat-Frames nebeneinander angeordnet, Intro-/Moderationsfluss stabilisiert, Storage/Events verdrahtet, minimaler Abgleich mit `USER_PROFILE.md` (Phase 1 für Sprache/CC).

---

## Completed

### 1) Owner Selection (index)
- Neuer CTA **“Select chat owner”**.
- Schwebendes Auswahlpanel (**Floating Panel**) erscheint **unter** dem CTA, überlagert Inhalte (kein Layout-Shift).
- Auswahl markierbar (persistentes Highlight), CTA wechselt auf **grün “› Select”**.
- Bestätigung setzt `owner_id` via `ChatMeta.setOwnerId()` und feuert **`owner:changed`**-Event.
- Anzeige **Name (CC)** über Frame + **“chat owner”**-Badge (8pt), ohne zusätzlichen Layoutabstand.

### 2) Add User (index)
- Eigener CTA **“Add user”** mit Floating Panel analog Owner.
- **Duplikatsperre**: bereits gewählte Profile (Owner/Teilnehmer) werden aus der Liste ausgeschlossen.
- Auswahl → Button wechselt auf **grün “› Add”**, Klick fügt User per Legacy-Flow hinzu:
  - `addUserSection()` → Felder vorbelegen → `saveUser()` → `createFrameForUser()`.

### 3) Start Chat (Top-Gate)
- Neuer Top-Button **“Start chat”**.
- **Disabled**, bis **≥ 2** gespeicherte Nutzer vorhanden sind.
- Bei Start:
  - Owner-/User-Controls werden **gesperrt/ausgeblendet**.
  - Bestehender Chat-Flow (`startChat()`) wird gestartet (Init-Loader, erste Moderationsnachricht).

### 4) Layout & Styling
- **Frames nebeneinander**: `#framesRow { display:flex; flex-wrap:wrap; gap:16px; }` + `.phone_frame { flex:0 0 auto; }`.
- Legacy-Name-Pills oberhalb der Frames **ausgeblendet**, nur noch ein sauberes Namens-Label.
- Floating Panels via JS exakt **unter** den auslösenden Buttons positioniert (keine Verschiebung der Frames).
- **Disabled-Button-Stil**: hellgrau + `cursor:not-allowed`.
- **Owner-Badge** in Blau (8pt), ohne Layoutsprung (inline, keine zusätzliche Höhe).
- **Active-Input-Outline** im Intro-Modus reaktiviert.

### 5) Chat Flow / Intro
- **Done/Next** wieder funktionsfähig:
  - Event-Delegation auf `#framesRow` stellt sicher, dass dynamisch erzeugte `-done` Buttons reagieren.
  - Netzwerk-Lock/Queue bleibt intakt (kein Skip während Send in Flight).

### 6) State / Storage / Events
- `boot()` initialisiert Storage-Driver **local**.
- `ChatMeta` liefert/setzt Owner und broadcastet `owner:changed` (aktiviert Add-User-Logik).
- Fallback: unsichtbarer `#users-container`, falls Legacy-Funktionen ihn erwarten.

### 7) Profiles (Phase 1)
- **Minimaler** Abgleich zu `USER_PROFILE.md`:
  - `profile.system.language` wird genutzt, um **(CC)** neben Namen zu rendern.
  - Vollständige Felder/Struktur für später geplant (nicht Teil des heutigen Scopes).

---

## Fixes & Cleanups
- Mehrere JSHint-Warnungen bereinigt (Doppel-Imports/Variablen, Semikolons).
- Doppelte UI-Labels entfernt.
- Panel-Positionierung korrigiert (keine Überdeckung der CTA-Buttons).
- Fehler beim Laden von `profileStore.js`-Exports (fehlende/umbenannte Exporte) behoben.

---

## Smoke Test (heute)
1. Seite laden → Banner & CTAs sichtbar, **Start chat** disabled.
2. **Select chat owner** → Panel öffnen → Profil wählen → Button wird grün → klicken → Owner gesetzt, Badge sichtbar.
3. **Add user** → mindestens einen weiteren Nutzer hinzufügen.
4. **Start chat** → Button wird aktiv → Klick startet Chat, Owner-/User-Controls verschwinden, Intro-Flow beginnt.
5. Aktiver Sprecher: blaue Input-Outline; **Done/Next** übergibt an nächsten User.

---

## Notes
- `USER_PROFILE.md`-Vollabdeckung folgt (separater Task).
- `script.js` ist derzeit groß; Aufteilung in Module + eigene CSS-Datei wird für morgen eingeplant.